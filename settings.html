<?php
// This file is part of Moodle - http://moodle.org/
//
// Moodle is free software: you can redistribute it and/or modify
// it under the terms of the GNU General Public License as published by
// the Free Software Foundation, either version 3 of the License, or
// (at your option) any later version.
//
// Moodle is distributed in the hope that it will be useful,
// but WITHOUT ANY WARRANTY; without even the implied warranty of
// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
// GNU General Public License for more details.
//
// You should have received a copy of the GNU General Public License
// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.

/**
* Admin config settings page for auth_saml2sso
*
* @package    auth_saml2sso
* @copyright  Daniel Miranda <daniellopes at gmail.com>
* @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
*/

$yesno = array(get_string('no'), get_string('yes'));

?>
<div>
    <div class="title">
        <h2><?php print_string('label_instructions_title', 'auth_saml2sso') ?></h2>
    </div>
    <div class="content">
        <?php print_string('label_instructions_p1', 'auth_saml2sso') ?>
    </div>
</div>
<table cellspacing="0" cellpadding="5" border="0" class="generaltable">
    <!-- sp_path -->
    <tr valign="top">
        <?php $field = 'sp_path'; ?>
        <td align="right">
            <label for="label_<?php echo $field; ?>"><?php print_string('label_' . $field, 'auth_saml2sso'); ?></label>
        </td>
        <td>
            <input type="text" name="<?php echo $field; ?>" value="<?php print $config->$field; ?>"><br />
            <?php if (isset($err[$field])) { echo $OUTPUT->notification($err[$field], 'notifyfailure'); } ?>
            <?php print_string('help_' . $field, 'auth_saml2sso') ?>
        </td>
    </tr>
    <!-- /sp_path -->
    <!-- dual_login -->
    <tr valign="top">
        <?php $field = 'dual_login'; ?>
        <td align="right">
            <label for="label_<?php $field; ?>"><?php print_string('label_' . $field, 'auth_saml2sso') ?></label>
        </td>
        <td><?php echo html_writer::select($yesno, $field, $config->$field, false); ?>
            <?php if (isset($err[$field])) { echo $OUTPUT->notification($err[$field], 'notifyfailure'); } ?>
            <?php print_string('help_' . $field, 'auth_saml2sso') ?>
        </td>
    </tr>
    <!-- /dual_login -->
    <!-- single_signoff -->
    <tr valign="top">
        <?php $field = 'single_signoff'; ?>
        <td align="right">
            <label for="label_<?php $field; ?>"><?php print_string('label_' . $field, 'auth_saml2sso') ?></label>
        </td>
        <td><?php echo html_writer::select($yesno, $field, $config->$field, false); ?>
            <?php if (isset($err[$field])) { echo $OUTPUT->notification($err[$field], 'notifyfailure'); } ?>
            <?php print_string('help_' . $field, 'auth_saml2sso') ?>
        </td>
    </tr>
    <!-- /single_signoff -->
    <!-- username_mapping -->
    <tr valign="top">
        <?php $field = 'username_mapping'; ?>
        <td align="right">
            <label for="label_<?php echo $field; ?>"><?php print_string('label_' . $field, 'auth_saml2sso') ?></label>
        </td>
        <td>
            <input type="text" size="25" name="idpattr" value="<?php print $config->idpattr; ?>">
            <?php if (isset($err[$field])) { echo $OUTPUT->notification($err[$field], 'notifyfailure'); } ?>
            <?php print_string('help_' . $field, 'auth_saml2sso') ?>
        </td>
    </tr>
    <!-- /username_mapping -->
    <!-- moodle_mapping -->
    <?php
    $fields = array(
    'username' => get_string('username'),
    'idnumber' => get_string('idnumber'),
    'email'    => get_string('email'),
    );
    ?>
    <tr valign="top">
        <?php $field = 'moodle_mapping'; ?>
        <td align="right">
            <label for="label_<?php echo $field; ?>"><?php print_string('label_' . $field, 'auth_saml2sso') ?></label>
        </td>
        <td>
            <?php echo html_writer::select($fields, 'mdlattr', $config->mdlattr, false) ?>
            <?php if (isset($err[$field])) { echo $OUTPUT->notification($err[$field], 'notifyfailure'); } ?>
            <?php print_string('help_' . $field, 'auth_saml2sso') ?>
        </td>
    </tr>
    <!-- /moodle_mapping -->
    <!-- autocreate -->
    <tr valign="top">
        <?php $field = 'autocreate'; ?>
        <td align="right">
            <label for="label_<?php echo $field; ?>"><?php print_string('label_' . $field, 'auth_saml2sso') ?></label>
        </td>
        <td><?php echo html_writer::select($yesno, $field, $config->$field, false) ?>
            <?php if (isset($err[$field])) { echo $OUTPUT->notification($err[$field], 'notifyfailure'); } ?>
            <?php print_string('help_' . $field, 'auth_saml2sso') ?>
        </td>
    </tr>
    <!-- /autocreate -->
    <!-- entityid -->
    <tr valign="top">
        <?php $field = 'entityid'; ?>
        <td align="right">
            <label for="label_<?php echo $field; ?>"><?php print_string('label_' . $field, 'auth_saml2sso') ?></label>
        </td>
        <td><input type="text" name="<?php echo $field; ?>" value="<?php echo $config->$field; ?>"><br />
            <?php if (isset($err[$field])) { echo $OUTPUT->notification($err[$field], 'notifyfailure'); } ?>
            <?php print_string('help_' . $field, 'auth_saml2sso') ?>
        </td>
    </tr>
    <!-- /entityid -->
    <!-- logout_url_redir -->
    <tr valign="top">
        <?php $field = 'logout_url_redir'; ?>
        <td align="right">
            <label for="label_<?php echo $field; ?>"><?php print_string('label_' . $field, 'auth_saml2sso') ?></label>
        </td>
        <td><input type="text" name="<?php echo $field; ?>" value="<?php echo $config->$field; ?>"><br />
            <?php if (isset($err[$field])) { echo $OUTPUT->notification($err[$field], 'notifyfailure'); } ?>
            <?php print_string('help_' . $field, 'auth_saml2sso') ?>
        </td>
    </tr>
    <!-- /logout_url_redir -->
    <!-- edit_profile -->
    <tr valign="top">
        <?php $field = 'edit_profile'; ?>
        <td align="right">
            <label for="label_<?php $field; ?>"><?php print_string('label_' . $field, 'auth_saml2sso') ?></label>
        </td>
        <td><?php echo html_writer::select($yesno, $field, $config->$field, false); ?>
            <?php if (isset($err[$field])) { echo $OUTPUT->notification($err[$field], 'notifyfailure'); } ?>
            <?php print_string('help_' . $field, 'auth_saml2sso') ?>
        </td>
    </tr>
    <!-- /edit_profile -->
    <!-- idp_fullname -->
    <tr valign="top">
        <?php $field = 'field_idp_fullname'; ?>
        <td align="right">
            <label for="label_<?php $field; ?>"><?php print_string('label_' . $field, 'auth_saml2sso') ?></label>
        </td>
        <td><?php echo html_writer::select($yesno, $field, $config->$field, false); ?>
            <?php if (isset($err[$field])) { echo $OUTPUT->notification($err[$field], 'notifyfailure'); } ?>
            <?php print_string('help_' . $field, 'auth_saml2sso') ?>
        </td>
    </tr>
    <!-- /edit_profile -->
    <!-- firstname_idp_field -->
    <tr valign="top">
        <?php $field = 'field_idp_firstname'; ?>
        <td align="right">
            <label for="label_<?php echo $field; ?>"><?php print_string('label_' . $field, 'auth_saml2sso') ?></label>
        </td>
        <td><input type="text" name="<?php echo $field; ?>" value="<?php echo $config->$field; ?>"><br />
            <?php if (isset($err[$field])) { echo $OUTPUT->notification($err[$field], 'notifyfailure'); } ?>
            <?php print_string('help_' . $field, 'auth_saml2sso') ?>
        </td>
    </tr>
    <!-- /firstname_idp_field -->
    <!-- lastname_idp_field -->
    <tr valign="top">
        <?php $field = 'field_idp_lastname'; ?>
        <td align="right">
            <label for="label_<?php echo $field; ?>"><?php print_string('label_' . $field, 'auth_saml2sso') ?></label>
        </td>
        <td><input type="text" name="<?php echo $field; ?>" value="<?php echo $config->$field; ?>"><br />
            <?php if (isset($err[$field])) { echo $OUTPUT->notification($err[$field], 'notifyfailure'); } ?>
            <?php print_string('help_' . $field, 'auth_saml2sso') ?>
        </td>
    </tr>
    <!-- /lastname_idp_field -->
    <?php print_auth_lock_options($this->authtype, $user_fields, '<!-- empty help -->', true, false); ?>
</table>